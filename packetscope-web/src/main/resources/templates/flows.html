<!DOCTYPE html>
<html lang="en">
<head>
    <title>PacketScope â€” Active Flows</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 6px; }
        th { background: #eee; }
    </style>
</head>

<body>

<h2>Active Flows (last 60s)</h2>

<table id="flows">
    <thead>
    <tr>
        <th>Protocol</th>
        <th>Endpoint 1</th>
        <th>Endpoint 2</th>
        <th>Packets</th>
        <th>Bytes</th>
        <th>First Seen</th>
        <th>Last Seen</th>
    </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
    async function refresh() {
        const res = await fetch('/flows/active');
        const data = await res.json();

        const tbody = document.querySelector('#flows tbody');
        tbody.innerHTML = '';

        data.forEach(r => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${r.protocol}</td>
                <td>${r.ep1}</td>
                <td>${r.ep2}</td>
                <td>${r.packet_count}</td>
                <td>${r.total_bytes}</td>
                <td>${r.first_seen}</td>
                <td>${r.last_seen}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    setInterval(refresh, 2000);
    refresh();
</script>

</body>
</html>